<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="description" content="Charlie Park is an indie web developer and family man. He lives in Virginia. You should grab a beer with him.">
	<link rel="alternate" href="http://charliepark.org/feed/" type="application/rss+xml">
  <meta name="viewport" content="width=device-width">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud" /> 
  <!--  old OpenID credentials; keep around for a bit longer <link rel="openid.server" href="http://charliepark.mp/server" /> <link rel="openid.delegate" href="http://charliepark.mp/"> -->
	<title>Charlie Park</title>
	<link href="/stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css">
</head>
<body>
	<header>
		<h1 class="site_title"><a href="/">Charlie Park</a> <span style="color:#ccc;font-size:19px;"></span></h1>
		<ul id="nav"><li class="nav_list_item" style="text-align:left"><a class="nav_list_link" href="/about">about me</a></li><li class="nav_list_item" style="left:2px;"><a class="nav_list_link" href="/projects">projects</a></li><li class="nav_list_item" style="text-align:right"><a class="nav_list_link" href="/archives">archives</a></li></ul>
	</header>
	</div>
	<section>
	
<article>
	<h2 class="post_title"><a href='/jekyll-with-plugins'>Deploying a Jekyll-Powered Site to Github <br />(Difficulty&colon; Plugins!)</a></h2>
	<div class="meta_wrapper"><time datetime='2011-06-15'>June 15, 2011</time><ul class="tag_list_in_post"><li class="inline archive_list"><a class="tag_list_link" href="/tag/jekyll">jekyll</a></li><li class="inline archive_list"><a class="tag_list_link" href="/tag/code">code</a></li><li class="inline archive_list"><a class="tag_list_link" href="/tag/github">github</a></li></ul></div>
	<p>Github&#8217;s <a href='http://pages.github.com/'>Pages</a> is a great &#8220;it just works&#8221; resource.</p>

<p>Except for when it doesn&#8217;t work.</p>

<p>So, for some reason, tags aren&#8217;t fully-implemented in <a href='http://jekyllrb.com/'>Jekyll</a>. They <em>kind of</em> work, but there&#8217;s no tag archive page. I went over this in my post on <a href='http://charliepark.org/tags-in-jekyll/'>getting tags to work in Jekyll</a>. The problem with that, though, is that <strong>Github disables any plugins you&#8217;re using when it processes/creates your blog</strong> (that&#8217;s what the <code>--safe</code> tag does).</p>

<p><strong>How, then, do you get your blog (with tags) to load up on Github?</strong></p>

<p><em>(I&#8217;m operating under the assumption here that you already have a Jekyll-powered blog set up on Github Pages, such that when you push commits to Github, it regenerates your blog for you.)</em></p>

<p>I&#8217;m going to lay out how to do this, and then how to automate the whole process so you can do it in just a few keystrokes.</p>

<h3 id='1_split_your_blog_in_two'>1. Split Your Blog in Two</h3>

<p>The first step is to clone your repo into a duplicate local copy. In my case, I took my local copy <code>~/applications/charliepark.github.com</code> and cloned it to <code>~/applications/charliepark.github.com.raw</code>.</p>

<p>This leaves you with the &#8220;raw&#8221; directory and the original directory (both identical).</p>

<h3 id='2_remove_your_old_content'>2. Remove Your Old Content</h3>

<p>In Finder, go into your original directory (again, in my case: <code>~/applications/charliepark.github.com</code>) and delete all of the content. You do <em>not</em> want to do this via the command line, as it&#8217;ll either be tedious (you&#8217;d need to remove each directory / file) or it&#8217;ll be too aggressive, and you&#8217;ll lose your .git directory. The point here: <strong>You don&#8217;t want to lose your .git directory, as that&#8217;s how your local copy will talk to your repo at Github.</strong></p>

<p>You should now have the &#8220;raw&#8221; directory (again, a clone of what you have at Github) and the now-empty (apart from your .git directory) original repo.</p>

<h3 id='3_regenerate_your_blog_in_the_raw_directory'>3. Regenerate Your Blog, in the &#8220;raw&#8221; Directory</h3>

<p>This is pretty straightforward. Just <code>cd</code> to the raw directory &#8230; in my case:</p>

<pre><code>cd ~/applications/charlie.github.com.raw</code></pre>

<p>&#8230; and run the <code>jekyll</code> command.</p>

<p>This will regenerate your blog, in the <code>~/applications/charlie.github.com.raw/_site</code> directory. You&#8217;ve probably already done this step once or twice before. (Note: You <em>don&#8217;t</em> want to run <code>jekyll --server</code>, as the point here is just to generate the blog, not to fire up a server.)</p>

<h3 id='4_copy_the__directory_over_to_your_original_repo'>4. Copy the <code>_site</code> Directory Over To Your Original Repo</h3>

<p>This is simple.</p>

<pre><code>cp -r ~/applications/charliepark.github.com.raw/_site/* ~/applications/charliepark.github.com</code></pre>

<p>Once you&#8217;ve run that command, you&#8217;ll now have:</p>

<ol>
<li>Your &#8220;raw&#8221; directory</li>

<li>A subdirectory within the &#8220;raw&#8221; directory (<code>_site</code>), with the generated <abbr>HTML</abbr></li>

<li>Your original directory, whose contents should now mirror the <code>_site</code> subdirectory of the &#8220;raw&#8221; directory</li>
</ol>

<h3 id='5_add_nojekyll'>5. Add .nojekyll</h3>

<p>When you add a file titled <code>.nojekyll</code> to your repo, Github won&#8217;t process your files as Jekyll files. I don&#8217;t think this step is strictly necessary, as we&#8217;re just sending the straight-up <abbr>HTML</abbr> files. But it can&#8217;t hurt. In your original directory (<code>~/applications/charliepark.github.com</code>), run:</p>

<pre><code>touch .nojekyll</code></pre>

<h3 id='6_commit_and_push_your_repo'>6. Commit and Push Your Repo</h3>

<p>Add the files to your original directory&#8217;s git repo:</p>

<pre><code>git add .</code></pre>

<p>Commit the new version of the repo:</p>

<pre><code>git commit -am &quot;Converts to flat HTML files.&quot;</code></pre>

<p>(Note: Your commit flags (<code>-am</code>) might differ from mine.)</p>

<p>Push the code to Github:</p>

<pre><code>git push</code></pre>

<h3 id='7_your_site_should_be_live'>7. Your Site Should Be Live</h3>

<p>You can now go to your site (http://yourusername.github.com) and see your site.</p>

<h3 id='8_automate_the_whole_thing'>8. Automate The Whole Thing</h3>

<p>Once you&#8217;ve checked that it works, and that everything&#8217;s okay, it&#8217;s a good idea to automate the whole thing.</p>

<p>I added a shortcut to my <code>~/.bash_profile</code> file:</p>

<pre><code>alias build_blog=&quot;cd ~/applications/charliepark.github.com.raw; jekyll;cp -r ~/applications/charliepark.github.com.raw/_site/* ~/applications/charliepark.github.com;cd ~/applications/charliepark.github.com;git add .;git commit -am &#39;Latest build.&#39;;git push&quot;
alias bb=&quot;build_blog&quot;</code></pre>

<p>So, now, once I&#8217;ve written a new post, or edited a post, or just want to get the site refreshed for some other reason, all I have to do in my command line is type <code>bb</code>, and it&#8217;ll regenerate the site, copy it over, run the git commits, and push it live to Github. I can now finish my post and then push it live to the site in about a second.</p>

<p>And it has <a href='http://charliepark.org/archives#tags'>tags</a>.</p>

<h3 id='corrections'>Corrections?</h3>

<p>I&#8217;m always half-expecting that some aspect of one of my writeups is totally broken. If you try this and have any issues, let me know (<a href='http://twitter.com/charliepark'>@charliepark</a>). Similarly, if you try it and it works, let me know.</p>
</article>

<article>
	<h2 class="post_title"><a href='/benchmarking-date.today-and-time.now-in-ruby'>Benchmarking Date.today and Time.now in Ruby</a></h2>
	<div class="meta_wrapper"><time datetime='2011-06-15'>June 15, 2011</time><ul class="tag_list_in_post"><li class="inline archive_list"><a class="tag_list_link" href="/tag/ruby">ruby</a></li><li class="inline archive_list"><a class="tag_list_link" href="/tag/code">code</a></li></ul></div>
	<p>There are often times when I can handle a programming issue in one of two (or more) ways. Dealing with Time / Date objects is one of those situations.</p>

<p>For example, if you want to know what day today is, you can either fetch Date.today.day or Time.now.day.</p>

<p>In my head, Date is a much simpler concept than Time. After all, Time deals with things like milliseconds and Epochs and things like that, where Date &#8230; well, I woke up this morning, and it was today&#8217;s date. And when I get up tomorrow, it&#8217;ll be tomorrow&#8217;s date. &#8220;Date&#8221; seems much more tangible.</p>

<p>I was curious, though, to know if there was a difference in how quickly Ruby could process the two. So I ran a test.</p>

<h3 id='the_first_test'>The First Test</h3>

<p>I was in a Rails app, so I fired up script/console, and added the following code:</p>

<pre><code>require &#39;benchmark&#39;

Benchmark.ms { 1000.times { puts Time.now } }

Benchmark.ms { 1000.times { puts Date.today } }</code></pre>

<h3 id='the_results'>The Results</h3>

<p>What I found was really interesting.</p>

<p>I ran the test a couple of times, and the average processing time for Time.now was 104 ms. The average processing time for Date.today was 251 ms.</p>

<p>That means it took Date.today about two and a half times as long to get processed than Time.now.</p>

<h3 id='the_second_test'>The Second Test</h3>

<p>I was curious to see if those results would hold if I ran a more complicated test. So I made the processing a tiny bit trickier:</p>

<pre><code>def month_name_t(month = Time.now.month)
  Date::MONTHNAMES[month]
end
Benchmark.ms { 1000.times { month_name_t } }

def month_name_d(month = Date.today.month)
  Date::MONTHNAMES[month]
end
Benchmark.ms { 1000.times { month_name_d } }</code></pre>

<h3 id='more_results'>More Results</h3>

<p>This time around, the difference was even more pronounced.</p>

<p>On average, month_name_t (Time.now) took 2 ms. And month_name_d (Date.today) took 80 ms.</p>

<p>So when we made the function just a bit more complex, it increased the processing time dramatically: <strong>Date.today took 40 times as long to process as Time.now.</strong></p>

<h3 id='the_conclusion'>The Conclusion</h3>

<p><strong>When you&#8217;re processing Times and Dates in your app, and you don&#8217;t <em>need</em> to use the Date object for some reason, use Time.</strong></p>
</article>

<article>
	<h2 class="post_title"><a href='/the-old-homepage'>The old homepage</a></h2>
	<div class="meta_wrapper"><time datetime='2011-06-08'>June  8, 2011</time><ul class="tag_list_in_post"><li class="inline archive_list"><a class="tag_list_link" href="/tag/pages">pages</a></li><li class="inline archive_list"><a class="tag_list_link" href="/tag/archives">archives</a></li></ul></div>
	<p>Just for posterity, I wanted to save / link to a copy of the old <a href='http://charliepark.org'>charliepark.org</a>.</p>

<p>So it&#8217;s now here: <a href='http://charliepark.org/oldindex.html'>oldindex.html</a>.</p>
</article>

<article>
	<h2 class="post_title"><a href='/tags-in-jekyll'>Tags In Jekyll</a></h2>
	<div class="meta_wrapper"><time datetime='2011-06-07'>June  7, 2011</time><ul class="tag_list_in_post"><li class="inline archive_list"><a class="tag_list_link" href="/tag/jekyll">jekyll</a></li><li class="inline archive_list"><a class="tag_list_link" href="/tag/code">code</a></li></ul></div>
	<div class='update_box'>
<p><strong>Update:</strong> This won&rsquo;t work if you&rsquo;re using Github pages to serve up your blog, as <a href='https://github.com/mojombo/jekyll/issues/325'>Github disables plugins.</a> You can still generate the site locally, commit it to your repo, and Github will serve it up. (That&rsquo;s what I&rsquo;m doing here.)</p>
</div>
<p>When I decided to convert my blog over to Jekyll, I was pretty excited about it. It seemed to offer the right balance between power and simplicity.</p>

<p>I realized pretty soon, though, that one of the main features I wanted to implement &#8211; tagging &#8211; isn&#8217;t well-supported in Jekyll.</p>

<p>I figured out how to get it working, though, and wanted to share what I came up with.</p>

<h2 id='the_problem'>The Problem</h2>

<p>I shouldn&#8217;t say that Jekyll doesn&#8217;t support tagging. It does. In the sense that you can add tags to a post.</p>

<p>But one of the necessary pages on a blog with tags is the tag archive page, where the blog automatically collects all posts tagged with &#8220;rails&#8221; or &#8220;experiments&#8221; or &#8220;recipes&#8221; or whatever.</p>

<p>For some reason, Jekyll doesn&#8217;t automatically produce those pages.</p>

<h2 id='the_process'>The Process</h2>

<p>I looked at a number of different blogs, and at the source code for a number of different Jekyll-powered blogs. I also poked around at Stack Overflow and Google Groups. They were useful in that they pointed me in the right direction. But all assumed more familiarity with Jekyll than I have, or they had some other issue that prevented my &#8220;getting it&#8221;.</p>

<p>Eventually, I figured out how to make it work, mainly by abusing some &#8220;Categories in Jekyll&#8221; code that others had put online. My approach ended up being almost identical to some code I found at <a href='http://brizzled.clapper.org/id/105/index.html'>http://brizzled.clapper.org/id/105/index.html</a>. In fact, I might have inadvertently lifted his code wholesale.</p>

<p>But nowhere in my escapades of ignorance did I find anyone who had written up an explanation of exactly what to do, where. So here you go.</p>

<h2 id='the_solution'>The Solution</h2>

<p>Jekyll recognizes tags out of the box. In your post&#8217;s <abbr>YAML</abbr> frontmatter, add tags like this:</p>

<pre><code>tags:
- jekyll
- code</code></pre>

<p>That sets up the post to have tags. To get the tags pulled onto a page, create two files:</p>

<pre><code>_layouts/tag_index.html</code></pre>

<p>and</p>

<pre><code>_plugins/_tag_gen.rb</code></pre>

<p>You probably already have a layouts directory, but you might need to add the plugins one. The tag_index.html file is necessary for the tag_gen.rb script to actually run.</p>

<p>In the tag_index file, put this:</p>

<pre><code>---
layout: default
---
&lt;h2 class=&quot;post_title&quot;&gt;Tags In Jekyll&lt;/h2&gt;
&lt;ul&gt;
  {.% for post in site.posts %}
  {.% for tag in post.tags %}
  {.% if tag == page.tag %}
  &lt;li class=&quot;archive_list&quot;&gt;
    &lt;time style=&quot;color:#666;font-size:11px;&quot; datetime=&#39;&#39;&gt;&lt;/time&gt; &lt;a class=&quot;archive_list_article_link&quot; href=&#39;&#39;&gt;&lt;/a&gt;
    &lt;p class=&quot;summary&quot;&gt;
    &lt;ul class=&quot;tag_list&quot;&gt;
      
    &lt;/ul&gt;
  &lt;/li&gt;
  {.% endif %}
  {.% endfor %}
  {.% endfor %}
&lt;/ul&gt;</code></pre>

<p><em>Note: In some of the lines up there, it has a &#8220;{.%&#8221; &#8230; get rid of that period between the curly bracket and the percent sign.</em></p>

<p><strong>What that does:</strong> When this page is created (more on that in a sec), it&#8217;ll have a specific tag assigned to it. That is, multiple pages will be created, each with their own official tag. This goes through every post in the site, and if the post has a tag that matches the tag for the page that&#8217;s being generated, the post is then listed, along with its publication date and summary. Obviously, if your posts don&#8217;t include a summary, you can leave that line off. Or, if there&#8217;s some other bit of metadata you want to include, you can add it into the layout.</p>

<p>In the tag_gen file. put this:</p>

<pre><code>module Jekyll
  class TagIndex &lt; Page
    def initialize(site, base, dir, tag)
      @site = site
      @base = base
      @dir = dir
      @name = &#39;index.html&#39;
      self.process(@name)
      self.read_yaml(File.join(base, &#39;_layouts&#39;), &#39;tag_index.html&#39;)
      self.data[&#39;tag&#39;] = tag
      tag_title_prefix = site.config[&#39;tag_title_prefix&#39;] || &#39;Posts Tagged &amp;ldquo;&#39;
      tag_title_suffix = site.config[&#39;tag_title_suffix&#39;] || &#39;&amp;rdquo;&#39;
      self.data[&#39;title&#39;] = &quot;#{tag_title_prefix}#{tag}#{tag_title_suffix}&quot;
    end
  end
  class TagGenerator &lt; Generator
    safe true
    def generate(site)
      if site.layouts.key? &#39;tag_index&#39;
        dir = site.config[&#39;tag_dir&#39;] || &#39;tag&#39;
        site.tags.keys.each do |tag|
          write_tag_index(site, File.join(dir, tag), tag)
        end
      end
    end
    def write_tag_index(site, dir, tag)
      index = TagIndex.new(site, site.source, dir, tag)
      index.render(site.layouts, site.site_payload)
      index.write(site.dest)
      site.pages &lt;&lt; index
    end
  end
end</code></pre>

<p><strong>What that does:</strong> Essentially, it creates a directory (folder) for each tag in your blog, and creates an index.html file in it. In that index.html file, it plugs in that template we just set up a few minutes ago. For the page title, it&#8217;ll combine the variables &#8220;tag_title_prefix&#8221; and &#8220;tag_title_suffix&#8221;, flanking the tag itself.</p>

<h2 id='thats_it'>That&#8217;s It</h2>

<p>I&#8217;m still learning a lot about Jekyll, and the liquid templating system. But I thought this might be useful to some of you who are considering Jekyll, but for whom tags are a deal-breaker. My entire site is at <a href='http://github.com/charliepark/charliepark.github.com'>http://github.com/charliepark/charliepark.github.com</a>, so if you want to see how I&#8217;m using it (or any tweaks I&#8217;ve made since posting this), you can check them out there.</p>
</article>

<p class="next_actions">To get updates when I post more, <a href="http://twitter.com/charliepark/">follow me on the Twitter machine</a>.</p>
	</section>
	<footer>
  </footer>
  <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
	<div id="search"><div id="cse" style="width: 100%;">Loading</div>
	<script src="http://www.google.com/jsapi" type="text/javascript"></script>
	<script type="text/javascript"> 
	  google.load('search', '1', {language : 'en'});
	  google.setOnLoadCallback(function() {
	    var customSearchControl = new google.search.CustomSearchControl('003013616125562838920:lezwpvqsqgo');
	    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
	    customSearchControl.draw('cse');
	  }, true);
	</script>
  <script type="text/javascript">
    try {
      var pageTracker = _gat._getTracker("UA-15921981-1");
      pageTracker._trackPageview();
    } catch(err) {}
  </script>
</body>
</html>